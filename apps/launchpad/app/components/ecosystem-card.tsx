import {
  Badge,
  Button,
  ButtonSize,
  ButtonVariant,
  Text,
  TextVariant,
  TextWeight,
} from '@0xintuition/1ui'

import { EpochStatus } from '@components/epoch-status'
import type { Epoch } from '@lib/types'
import { Link } from '@remix-run/react'

// Extend the Epoch type to include total_points
interface ExtendedEpoch extends Epoch {
  total_points?: number
}

interface EcosystemCardProps {
  epoch: ExtendedEpoch
}

export default function EcosystemCard({ epoch }: EcosystemCardProps) {
  // Determine if this is an Arbitrum epoch
  const isArbitrumEpoch = epoch.name.toLowerCase().includes('arbitrum')

  // Set background color based on epoch type
  const bgColor = isArbitrumEpoch ? 'bg-[#213147]' : 'bg-[#0052FF]'

  return (
    <div className="rounded-lg shadow-sm overflow-hidden aspect-square bg-primary/5 backdrop-blur-md backdrop-saturate-150 border border-border/10 p-0 relative group">
      {/* Content */}
      <div className="relative h-full p-5 flex flex-col justify-between">
        <div
          className={`flex items-center justify-center ${bgColor} h-full mb-2.5 rounded-md`}
        >
          {isArbitrumEpoch ? (
            <svg
              width="218"
              height="59"
              viewBox="0 0 1657.31 422.01"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              className="opacity-90"
            >
              <defs>
                <style>
                  {`
                    .cls-1 { fill: #fff; }
                    .cls-2 { fill: #9dcced; }
                    .cls-3 { fill: #213147; }
                    .cls-4 { fill: #12aaff; }
                  `}
                </style>
              </defs>
              <g>
                <path
                  className="cls-3"
                  d="m14.16,128.27v165.47c0,10.53,5.61,20.28,14.76,25.55l143.29,82.69c9.15,5.27,20.37,5.27,29.52,0l143.29-82.69c9.15-5.27,14.76-15.02,14.76-25.55v-165.47c0-10.53-5.61-20.28-14.76-25.55L201.73,20.03c-9.15-5.27-20.37-5.27-29.52,0L28.92,102.72c-9.06,5.27-14.76,15.02-14.76,25.55Z"
                />
                <g>
                  <path
                    className="cls-4"
                    d="m218.3,243.07l-20.46,56.02c-.6,1.55-.6,3.28,0,4.83l35.13,96.42,40.66-23.48-48.77-133.79c-1.12-3.11-5.44-3.11-6.56,0Z"
                  />
                  <path
                    className="cls-4"
                    d="m259.21,148.81c-1.12-3.11-5.44-3.11-6.56,0l-20.46,56.02c-.6,1.55-.6,3.28,0,4.83l57.57,157.88,40.66-23.48-71.21-195.25Z"
                  />
                </g>
                <path
                  className="cls-2"
                  d="m186.97,26.15c1.04,0,1.99.26,2.93.78l155.03,89.51c1.81,1.04,2.93,2.93,2.93,5.01v179.02c0,2.07-1.12,3.97-2.93,5.01l-155.03,89.6c-.86.52-1.9.78-2.93.78s-1.99-.26-2.93-.78L29.09,305.57c-1.81-1.04-2.93-2.93-2.93-5.01V121.45c0-2.07,1.12-3.97,2.93-5.01L184.12,26.93c.86-.52,1.9-.78,2.85-.78m0-26.15c-5.52,0-11.05,1.47-15.97,4.32L15.97,93.83C6.13,99.52,0,110.06,0,121.45v179.02c0,11.39,6.13,22.01,15.97,27.71l155.03,89.51c4.92,2.85,10.44,4.32,15.97,4.32s11.05-1.47,15.97-4.32l155.03-89.51c9.93-5.7,15.97-16.23,15.97-27.71V121.45c0-11.39-6.13-22.01-15.97-27.71L203.02,4.32c-5.01-2.85-10.53-4.32-16.06-4.32h0Z"
                />
                <polygon
                  className="cls-3"
                  points="84.51 367.72 98.75 328.7 127.41 352.52 100.65 377.04 84.51 367.72"
                />
                <g>
                  <path
                    className="cls-1"
                    d="m173.93,108.67h-39.27c-2.93,0-5.61,1.81-6.56,4.57l-84.25,230.99,40.66,23.48,92.79-254.38c.78-2.24-.86-4.66-3.37-4.66Z"
                  />
                  <path
                    className="cls-1"
                    d="m242.73,108.67h-39.27c-2.93,0-5.61,1.81-6.56,4.57l-96.24,263.79,40.66,23.48L246.01,113.42c.86-2.33-.86-4.75-3.28-4.75Z"
                  />
                </g>
              </g>
              <g>
                <path
                  className="cls-1"
                  d="m541.3,156.75c3.88,0,7.25.78,9.93,2.42,2.68,1.64,5.35,4.75,7.94,9.41l51.27,93.05c.52,1.04.6,1.9.35,2.59-.26.69-1.04,1.04-2.24,1.04h-19.68c-1.73,0-2.93-.69-3.54-1.99l-10.96-19.94h-72.77l-10.7,19.94c-.69,1.38-1.9,1.99-3.54,1.99h-20.11c-1.38,0-2.16-.35-2.42-1.04-.26-.69-.17-1.55.35-2.59l50.84-93.05c2.59-4.66,5.09-7.77,7.6-9.41,2.5-1.64,5.35-2.42,8.63-2.42h9.06Zm-30.13,68.45h53.34l-24.6-45.4c-.43-.69-.95-1.12-1.73-1.12h-.95c-.69,0-1.29.35-1.73,1.12l-24.34,45.4Z"
                />
                <path
                  className="cls-1"
                  d="m723.09,156.75c11.91,0,20.37,2.68,25.55,8.03,5.18,5.35,7.77,13.29,7.77,23.82v8.8c0,8.89-1.81,15.88-5.44,21.06-3.63,5.18-9.5,8.46-17.7,9.93l26.5,32.8c.52.52.69,1.29.43,2.33-.17,1.04-1.04,1.55-2.5,1.55h-19.94c-1.38,0-2.24-.17-2.76-.43-.52-.35-1.04-.86-1.55-1.55l-24.51-32.2h-50.06v30.82c0,2.24-1.12,3.37-3.37,3.37h-16.75c-2.42,0-3.54-1.12-3.54-3.37v-100.3c0-3.11,1.55-4.66,4.66-4.66h83.21Zm-64.13,55.33h59.3c5.27,0,8.98-1.12,11.14-3.37,2.16-2.24,3.28-5.7,3.28-10.36v-6.47c0-4.66-1.12-8.11-3.28-10.36-2.16-2.24-5.87-3.37-11.14-3.37h-57.32c-1.38,0-1.99.6-1.99,1.9v32.02Z"
                />
                <path
                  className="cls-1"
                  d="m885.97,156.75c10.62,0,18.21,2.16,22.7,6.39,4.49,4.23,6.73,10.62,6.73,19.16v7.42c0,8.63-3.28,15.19-9.93,19.68,7.08,4.14,10.7,10.79,10.7,19.94v8.98c0,4.14-.43,7.85-1.38,11.14-.95,3.28-2.42,6.13-4.57,8.46-2.16,2.33-4.92,4.14-8.46,5.35-3.54,1.21-7.85,1.9-13.03,1.9h-92.02c-3.11,0-4.66-1.55-4.66-4.66v-99.09c0-3.11,1.55-4.66,4.66-4.66h89.25Zm-70.18,45.06h63.53c5.18,0,8.63-.78,10.53-2.33,1.9-1.55,2.76-3.8,2.76-6.82v-5.27c0-3.19-.86-5.52-2.68-7.08-1.81-1.47-4.75-2.24-8.72-2.24h-63.36c-1.38,0-1.99.69-1.99,1.99v21.75h-.09Zm0,16.92v23.05c0,1.38.69,1.99,1.99,1.99h63.53c4.14,0,7.08-.78,8.8-2.24s2.68-3.88,2.68-7.16v-5.87c0-3.19-.95-5.61-2.85-7.25-1.9-1.64-5.44-2.5-10.62-2.5h-63.53Z"
                />
                <path
                  className="cls-1"
                  d="m973.93,156.75c2.24,0,3.37,1.12,3.37,3.37v101.6c0,2.24-1.12,3.37-3.37,3.37h-16.75c-2.42,0-3.54-1.12-3.54-3.37v-101.51c0-2.24,1.21-3.37,3.54-3.37l16.75-.09Z"
                />
                <path
                  className="cls-1"
                  d="m1136.21,156.75c2.42,0,3.54,1.12,3.54,3.37v15.19c0,2.42-1.21,3.54-3.54,3.54h-48.6v82.87c0,2.24-1.12,3.37-3.37,3.37h-16.92c-2.24,0-3.37-1.12-3.37-3.37v-82.87h-48.6c-2.42,0-3.54-1.21-3.54-3.54v-15.19c0-2.24,1.21-3.37,3.54-3.37h120.85Z"
                />
                <path
                  className="cls-1"
                  d="m1258.69,156.75c11.91,0,20.37,2.68,25.55,8.03,5.18,5.35,7.77,13.29,7.77,23.82v8.8c0,8.89-1.81,15.88-5.44,21.06-3.63,5.18-9.5,8.46-17.7,9.93l26.5,32.8c.52.52.69,1.29.43,2.33-.17,1.04-1.04,1.55-2.5,1.55h-19.94c-1.38,0-2.24-.17-2.76-.43-.52-.35-1.04-.86-1.55-1.55l-24.51-32.2h-50.06v30.82c0,2.24-1.12,3.37-3.37,3.37h-16.75c-2.42,0-3.54-1.12-3.54-3.37v-100.3c0-3.11,1.55-4.66,4.66-4.66h83.21Zm-64.05,55.33h59.3c5.27,0,8.98-1.12,11.14-3.37,2.16-2.24,3.28-5.7,3.28-10.36v-6.47c0-4.66-1.12-8.11-3.28-10.36-2.16-2.24-5.87-3.37-11.14-3.37h-57.32c-1.38,0-1.99.6-1.99,1.9v32.02h0Z"
                />
                <path
                  className="cls-1"
                  d="m1345.79,156.75c2.24,0,3.37,1.12,3.37,3.37v61.8c0,4.14.35,7.6,1.04,10.27.69,2.76,1.81,4.92,3.37,6.47,1.55,1.64,3.63,2.76,6.3,3.37,2.68.69,5.96,1.04,10.01,1.04h42.9c4.06,0,7.34-.35,10.01-1.04,2.68-.69,4.75-1.81,6.3-3.37,1.55-1.64,2.68-3.8,3.28-6.47.6-2.76.95-6.13.95-10.27v-61.8c0-2.24,1.12-3.37,3.37-3.37h16.92c2.24,0,3.37,1.12,3.37,3.37v64.13c0,7.42-.78,13.72-2.33,18.99-1.55,5.18-4.06,9.41-7.51,12.69-3.45,3.28-7.94,5.61-13.47,7.08-5.52,1.47-12.17,2.16-20.03,2.16h-44.63c-7.85,0-14.5-.69-19.94-2.16-5.44-1.47-9.93-3.8-13.38-7.08-3.45-3.28-5.96-7.51-7.6-12.69-1.64-5.18-2.42-11.57-2.42-18.99v-64.13c0-2.24,1.21-3.37,3.54-3.37h16.57Z"
                />
                <path
                  className="cls-1"
                  d="m1523.52,156.75c2.24,0,4.23.17,5.87.43,1.64.35,3.11.86,4.32,1.81,1.21.86,2.33,2.07,3.37,3.54.95,1.47,1.99,3.45,3.02,5.96l32.2,74.32c.43.95,1.12,1.38,2.16,1.38h1.9c1.04,0,1.73-.43,2.16-1.38l32.2-74.32c1.04-2.5,2.07-4.49,3.02-5.96s2.07-2.68,3.37-3.54c1.21-.86,2.68-1.47,4.23-1.81,1.64-.35,3.54-.43,5.78-.43h16.57c5.35,0,8.98,1.21,10.88,3.63,1.9,2.42,2.76,6.56,2.76,12.43v88.91c0,2.24-1.21,3.37-3.54,3.37h-15.8c-2.24,0-3.37-1.12-3.37-3.37v-80.88c0-1.04-.43-1.55-1.21-1.55h-1.38c-1.04,0-1.73.43-1.99,1.21l-31.25,69.4c-1.21,2.76-2.5,5.18-3.8,7.08-1.29,1.9-2.68,3.45-4.14,4.75-1.47,1.21-3.19,2.16-5.09,2.68-1.9.52-4.14.78-6.73.78h-7.42c-2.59,0-4.83-.26-6.73-.78-1.9-.52-3.63-1.38-5.09-2.68-1.47-1.21-2.93-2.85-4.14-4.75-1.29-1.9-2.59-4.23-3.8-7.08l-31.25-69.4c-.35-.86-.95-1.21-1.99-1.21h-1.38c-.86,0-1.21.52-1.21,1.55v80.88c0,2.24-1.12,3.37-3.37,3.37h-15.8c-2.42,0-3.54-1.12-3.54-3.37v-88.91c0-5.87.95-10.01,2.76-12.43,1.9-2.42,5.52-3.63,10.96-3.63h16.49Z"
                />
                <path
                  className="cls-1"
                  d="m1523.52,156.75c2.24,0,4.23.17,5.87.43,1.64.35,3.11.86,4.32,1.81,1.21.86,2.33,2.07,3.37,3.54.95,1.47,1.99,3.45,3.02,5.96l32.2,74.32c.43.95,1.12,1.38,2.16,1.38h1.9c1.04,0,1.73-.43,2.16-1.38l32.2-74.32c1.04-2.5,2.07-4.49,3.02-5.96s2.07-2.68,3.37-3.54c1.21-.86,2.68-1.47,4.23-1.81,1.64-.35,3.54-.43,5.78-.43h16.57c5.35,0,8.98,1.21,10.88,3.63,1.9,2.42,2.76,6.56,2.76,12.43v88.91c0,2.24-1.21,3.37-3.54,3.37h-15.8c-2.24,0-3.37-1.12-3.37-3.37v-80.88c0-1.04-.43-1.55-1.21-1.55h-1.38c-1.04,0-1.73.43-1.99,1.21l-31.25,69.4c-1.21,2.76-2.5,5.18-3.8,7.08-1.29,1.9-2.68,3.45-4.14,4.75-1.47,1.21-3.19,2.16-5.09,2.68-1.9.52-4.14.78-6.73.78h-7.42c-2.59,0-4.83-.26-6.73-.78-1.9-.52-3.63-1.38-5.09-2.68-1.47-1.21-2.93-2.85-4.14-4.75-1.29-1.9-2.59-4.23-3.8-7.08l-31.25-69.4c-.35-.86-.95-1.21-1.99-1.21h-1.38c-.86,0-1.21.52-1.21,1.55v80.88c0,2.24-1.12,3.37-3.37,3.37h-15.8c-2.42,0-3.54-1.12-3.54-3.37v-88.91c0-5.87.95-10.01,2.76-12.43,1.9-2.42,5.52-3.63,10.96-3.63h16.49Z"
                />
              </g>
            </svg>
          ) : (
            <svg
              width="208"
              height="56"
              viewBox="0 0 416 111"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              className="opacity-90"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M110.034 55.017C110.034 85.402 85.359 110.034 54.921 110.034C26.0432 110.034 2.35281 87.8625 0 59.6416H72.8467V50.3923H0C2.35281 22.1714 26.0432 0 54.921 0C85.359 0 110.034 24.6319 110.034 55.017ZM314.358 100.066C333.455 100.066 345.98 89.7739 345.98 74.2731C345.98 59.8883 336.555 53.068 322.295 50.7119L309.646 48.6037C299.974 46.9917 293.525 42.7754 293.525 33.4749C293.525 24.0505 300.718 16.8581 314.358 16.8581C327.627 16.8581 334.447 23.5544 335.191 33.1029H344.74C343.996 20.4543 334.323 9.16968 314.482 9.16968C294.889 9.16968 284.101 20.2062 284.101 33.847C284.101 48.3557 293.897 55.0521 307.29 57.2842L320.063 59.2683C330.727 61.1284 336.679 65.4686 336.679 74.6451C336.679 85.4337 327.875 92.378 314.482 92.378C300.594 92.378 291.913 85.6817 291.169 74.2731H281.745C282.489 89.1539 293.897 100.066 314.358 100.066ZM173.574 98.3303H138.852V11.0298H172.334C187.091 11.0298 197.383 19.7102 197.383 33.599C197.383 43.6435 191.679 50.3398 182.503 52.5719V52.944C193.415 55.0521 200.111 62.4925 200.111 74.1491C200.111 89.1539 189.075 98.3303 173.574 98.3303ZM171.094 49.3478C181.635 49.3478 188.083 43.6435 188.083 34.715V33.4749C188.083 24.5465 181.635 18.9662 171.094 18.9662H148.153V49.3478H171.094ZM172.21 90.3939C183.743 90.3939 190.811 84.0696 190.811 74.3971V73.157C190.811 63.1125 183.619 57.0362 172.086 57.0362H148.153V90.3939H172.21ZM275.216 98.3303H265.295L257.855 74.6451H223.133L215.693 98.3303H206.268L234.914 11.0298H246.198L275.216 98.3303ZM240.99 20.5783H240.246L225.613 66.8327H255.499L240.99 20.5783ZM359.949 98.3303V11.0298H416V19.0902H369.25V49.0998H412.28V57.0362H369.25V90.2699H416V98.3303H359.949Z"
                fill="white"
              />
            </svg>
          )}
        </div>

        {/* Bottom Content */}
        <div className="flex flex-col gap-4">
          <div className="flex flex-col gap-3">
            <div className="flex items-end justify-between">
              <div className="space-y-1">
                <Text
                  variant={TextVariant.headline}
                  weight={TextWeight.semibold}
                  className="text-white"
                >
                  {epoch.name}
                </Text>
                <Text variant={TextVariant.body} className="text-white/70">
                  {epoch.description}
                </Text>
              </div>
              <div className="flex flex-col items-end gap-2">
                <Badge className="bg-white/5 border-white/10">
                  <EpochStatus
                    startDate={epoch.start_date}
                    endDate={epoch.end_date}
                    isActive={epoch.is_active}
                    className="text-white"
                  />
                </Badge>
                {epoch.is_active &&
                  typeof epoch.total_points === 'number' &&
                  epoch.total_points > 0 && (
                    <Text
                      variant={TextVariant.body}
                      className="text-white/70 font-medium"
                    >
                      Earn up to{' '}
                      <span className="text-success font-semibold">
                        {epoch.total_points}
                      </span>{' '}
                      IQ
                    </Text>
                  )}
              </div>
            </div>

            <div className="flex border-t border-white/10 pt-4">
              <Link to={`/quests/ecosystems/${epoch.id}`} className="w-full">
                <Button
                  variant={ButtonVariant.primary}
                  className="w-full justify-center transition-colors"
                  size={ButtonSize.lg}
                >
                  {epoch.is_active ? 'Start Mapping' : 'View Details'}
                </Button>
              </Link>
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}
