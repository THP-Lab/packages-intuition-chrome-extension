import { useState } from 'react'

import { Popover, PopoverContent, PopoverTrigger } from '@0xintuition/1ui'

import { Link } from '@remix-run/react'

interface LegionPopoverProps {
  title?: string
  description?: string
  ctaText?: string
  ctaHref?: string
  defaultOpen?: boolean
}

export function LegionPopover({
  title = 'Intuition is coming to Legion',
  description = 'Join the community now & get your application submitted before May 22nd!',
  ctaText = 'Apply Now',
  ctaHref = '#',
  defaultOpen = true,
}: LegionPopoverProps) {
  const [open, setOpen] = useState(defaultOpen)

  return (
    <Popover open={open} onOpenChange={setOpen}>
      <PopoverTrigger asChild>
        <button
          className="bg-[#F03C24] text-white font-medium px-4 py-2 rounded hover:bg-[#d33520] transition-colors"
          aria-label="Open Legion announcement"
        >
          <svg
            width="81"
            height="16"
            viewBox="0 0 324 64"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M8.97328 61.4325H0V2.18867H8.96777L8.97328 61.4325ZM16.1024 53.7103V61.4325H45.7857V53.7103H16.1024ZM269.19 32.0343C269.19 36.0725 268.593 39.9597 267.401 43.6931C266.206 47.4266 264.42 50.7345 262.033 53.6087C259.647 56.4857 256.68 58.7669 253.132 60.4552C250.704 61.6082 248.001 62.3686 245.028 62.7337V54.9758C246.716 54.6437 248.257 54.1001 249.647 53.3479C252.141 51.9973 254.183 50.2129 255.774 47.9893C257.365 45.7657 258.532 43.2649 259.275 40.4895C260.019 37.7114 260.39 34.8921 260.39 32.0371C260.39 29.1821 260.019 26.3628 259.275 23.5819C258.532 20.8038 257.365 18.3029 255.774 16.082C254.183 13.8584 252.138 12.0741 249.647 10.7234C247.153 9.37281 244.18 8.70024 240.732 8.70024C237.283 8.70024 234.31 9.37556 231.819 10.7234C229.325 12.0741 227.283 13.8584 225.692 16.082C224.101 18.3056 222.931 20.8038 222.19 23.5819C221.447 26.36 221.076 29.1793 221.076 32.0371C221.076 34.8948 221.447 37.7114 222.19 40.4895C222.934 43.2676 224.101 45.7685 225.692 47.9893C227.283 50.2129 229.325 51.9973 231.819 53.3479C233.209 54.1001 234.75 54.6437 236.438 54.9758V62.7337C233.465 62.3686 230.762 61.6109 228.334 60.4552C224.783 58.7697 221.816 56.4857 219.432 53.6087C217.046 50.7318 215.257 47.4266 214.065 43.6931C212.873 39.9597 212.276 36.0725 212.276 32.0343C212.276 27.9961 212.87 24.109 214.065 20.3755C215.257 16.6421 217.046 13.3369 219.432 10.4599C221.816 7.58295 224.786 5.28798 228.334 3.57224C231.882 1.85924 236.016 1 240.732 1C245.447 1 249.578 1.85924 253.129 3.57224C256.68 5.28798 259.647 7.58295 262.031 10.4599C264.414 13.3369 266.204 16.6421 267.398 20.3755C268.59 24.109 269.187 27.9961 269.187 32.0343H269.19ZM163.512 53.7103H181.734V61.4325H163.512V53.7103ZM181.736 2.18867H163.515V9.91087H181.736V2.18867ZM190.322 61.4325H209.295V53.7103H190.322V61.4325ZM181.736 9.91087V53.7075H190.322V9.91087H181.736ZM190.322 2.18867V9.91087H209.295V2.18867H190.322ZM323.677 17.7127V61.5094H314.109L284.61 16.3072V61.5094H276.049V2.26553H285.229L315.116 48.3352V17.7127H323.677ZM323.677 9.98774V2.26553H315.116V9.98774H323.677ZM98.7005 53.7103V61.4325H52.9176V34.8289H61.8908L61.8853 53.7075H98.7005V53.7103ZM61.8853 27.1067V9.91087H98.4556V2.18867H52.9176V27.1067H61.8853ZM93.7817 27.1067H61.8771V34.8015H93.7817V27.1067ZM156.019 34.8866V61.4847H147.825V55.6127C145.692 58.0175 143.14 59.8156 140.22 60.9658C136.79 62.3164 133.286 63 129.801 63C125.384 63 121.373 62.1737 117.88 60.5431C114.393 58.9152 111.39 56.6888 108.954 53.9272C106.52 51.171 104.643 47.9564 103.372 44.3739C102.103 40.8024 101.461 37.0415 101.461 33.19C101.461 28.9158 102.061 24.7925 103.242 20.9328C104.429 17.0538 106.22 13.6059 108.568 10.685C110.925 7.75316 113.903 5.38681 117.418 3.64636C120.941 1.90591 125.106 1.02471 129.801 1.02471C132.992 1.02471 136.047 1.4008 138.888 2.142C141.745 2.88869 144.338 4.08284 146.592 5.69152C148.849 7.30294 150.787 9.36458 152.301 11.8462C155.152 16.5158 155.554 21.5175 155.554 21.5175H146.578C146.578 21.5175 146.165 18.3551 144.459 15.5056C143.528 13.9518 142.243 12.7137 140.795 11.7337C139.336 10.7482 137.654 9.99597 135.799 9.49909C133.928 8.99947 131.91 8.74691 129.799 8.74691C126.386 8.74691 123.427 9.43321 121.002 10.7838C118.566 12.1427 116.548 13.9573 115.007 16.1726C113.451 18.4072 112.287 20.9959 111.549 23.8674C110.803 26.7581 110.426 29.7586 110.426 32.7865C110.426 35.8144 110.856 38.631 111.704 41.3515C112.546 44.0582 113.801 46.485 115.433 48.5576C117.054 50.622 119.086 52.2883 121.472 53.5181C123.845 54.7425 126.647 55.3629 129.796 55.3629C132.744 55.3629 135.381 54.8852 137.635 53.9464C139.881 53.0075 141.8 51.7008 143.338 50.0647C144.877 48.4231 146.055 46.4712 146.837 44.2586C147.363 42.7707 147.693 41.1703 147.82 39.4957V34.8893H156.014L156.019 34.8866ZM147.825 27.1589H128.742V34.8536H147.825V27.1589Z"
              fill="currentColor"
            />
          </svg>
        </button>
      </PopoverTrigger>
      <PopoverContent
        className="w-[320px] border-2 border-[#F03C24]/50 bg-[hsl(0_0%_8%)]"
        side="top"
        align="end"
        sideOffset={10}
      >
        <div className="relative">
          <button
            onClick={() => setOpen(false)}
            className="text-white/60 hover:text-white transition-colors absolute -top-1 -right-1"
            aria-label="Close Legion announcement"
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              strokeWidth="2"
              strokeLinecap="round"
              strokeLinejoin="round"
            >
              <path d="M18 6L6 18" />
              <path d="M6 6L18 18" />
            </svg>
          </button>
          <div className="flex flex-col gap-4 pt-4 px-4 pb-3">
            <div className="flex items-center justify-center rounded-lg bg-[#2C0F0C] p-3">
              <svg
                className="h-6"
                viewBox="0 0 165 32"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M4.56043 31.191H0V0.613505H4.55763L4.56043 31.191ZM8.18359 27.2053V31.191H23.2694V27.2053H8.18359ZM136.809 16.0177C136.809 18.1019 136.505 20.1082 135.899 22.0352C135.292 23.9621 134.384 25.6694 133.172 27.1529C131.959 28.6378 130.451 29.8152 128.647 30.6866C127.414 31.2816 126.04 31.6741 124.529 31.8626V27.8585C125.387 27.6871 126.17 27.4065 126.876 27.0183C128.144 26.3212 129.182 25.4002 129.99 24.2526C130.799 23.1049 131.392 21.8141 131.77 20.3817C132.148 18.9478 132.336 17.4927 132.336 16.0191C132.336 14.5456 132.148 13.0905 131.77 11.6552C131.392 10.2213 130.799 8.93053 129.99 7.78428C129.182 6.63662 128.142 5.71565 126.876 5.01855C125.609 4.32145 124.098 3.97432 122.345 3.97432C120.593 3.97432 119.082 4.32287 117.816 5.01855C116.548 5.71565 115.51 6.63662 114.702 7.78428C113.893 8.93195 113.299 10.2213 112.922 11.6552C112.545 13.089 112.356 14.5442 112.356 16.0191C112.356 17.4941 112.545 18.9478 112.922 20.3817C113.3 21.8155 113.893 23.1063 114.702 24.2526C115.51 25.4002 116.548 26.3212 117.816 27.0183C118.522 27.4065 119.306 27.6871 120.163 27.8585V31.8626C118.652 31.6741 117.279 31.2831 116.045 30.6866C114.24 29.8166 112.732 28.6378 111.521 27.1529C110.308 25.668 109.399 23.9621 108.793 22.0352C108.187 20.1082 107.884 18.1019 107.884 16.0177C107.884 13.9335 108.186 11.9272 108.793 10.0003C109.399 8.07332 110.308 6.36741 111.521 4.88253C112.732 3.39765 114.242 2.21315 116.045 1.32761C117.848 0.44348 119.949 0 122.345 0C124.742 0 126.841 0.44348 128.646 1.32761C130.451 2.21315 131.959 3.39765 133.17 4.88253C134.382 6.36741 135.291 8.07332 135.898 10.0003C136.504 11.9272 136.807 13.9335 136.807 16.0177H136.809ZM83.1005 27.2053H92.3613V31.191H83.1005V27.2053ZM92.3627 0.613505H83.1019V4.59916H92.3627V0.613505ZM96.7259 31.191H106.369V27.2053H96.7259V31.191ZM92.3627 4.59916V27.2039H96.7259V4.59916H92.3627ZM96.7259 0.613505V4.59916H106.369V0.613505H96.7259ZM164.5 8.6259V31.2306H159.637L144.645 7.90047V31.2306H140.295V0.653177H144.96L160.149 24.4311V8.6259H164.5ZM164.5 4.63883V0.653177H160.149V4.63883H164.5ZM50.1619 27.2053V31.191H26.8939V17.4601H31.4544L31.4516 27.2039H50.1619V27.2053ZM31.4516 13.4744V4.59916H50.0374V0.613505H26.8939V13.4744H31.4516ZM47.6621 13.4744H31.4474V17.4459H47.6621V13.4744ZM79.2927 17.4898V31.2179H75.1282V28.1872C74.044 29.4284 72.7472 30.3564 71.263 30.9501C69.52 31.6472 67.7392 32 65.9681 32C63.7229 32 61.6847 31.5735 59.9095 30.7319C58.1371 29.8917 56.6109 28.7426 55.3728 27.3172C54.1362 25.8947 53.1822 24.2356 52.5359 22.3865C51.891 20.5432 51.565 18.6021 51.565 16.6142C51.565 14.4081 51.87 12.28 52.4701 10.2879C53.073 8.28585 53.9837 6.50627 55.177 4.99872C56.3745 3.4855 57.8881 2.26416 59.6745 1.36586C61.4651 0.467567 63.5816 0.0127518 65.9681 0.0127518C67.5895 0.0127518 69.1423 0.206863 70.5859 0.589418C72.038 0.974806 73.3558 1.59114 74.5015 2.42143C75.6486 3.25313 76.6334 4.3172 77.4028 5.59805C78.8521 8.00815 79.0563 10.5897 79.0563 10.5897H74.4945C74.4945 10.5897 74.2846 8.95745 73.4173 7.48674C72.9445 6.68479 72.2912 6.04578 71.5554 5.53996C70.814 5.0313 69.9592 4.64308 69.0164 4.38663C68.0651 4.12876 67.0397 3.99841 65.9667 3.99841C64.2321 3.99841 62.7283 4.35262 61.4958 5.04972C60.2578 5.75107 59.2324 6.68762 58.449 7.83104C57.6587 8.98437 57.0669 10.3205 56.692 11.8025C56.3129 13.2945 56.1213 14.8431 56.1213 16.4059C56.1213 17.9687 56.3395 19.4224 56.7703 20.8266C57.1984 22.2236 57.8363 23.4761 58.6659 24.5458C59.4898 25.6113 60.5222 26.4714 61.7351 27.1061C62.9409 27.7381 64.365 28.0583 65.9653 28.0583C67.4636 28.0583 68.8037 27.8117 69.9494 27.3272C71.0909 26.8426 72.066 26.1682 72.848 25.3237C73.6299 24.4764 74.2287 23.469 74.626 22.327C74.8932 21.5591 75.061 20.7331 75.1254 19.8688V17.4913H79.2899L79.2927 17.4898ZM75.1282 13.5014H65.4296V17.4728H75.1282V13.5014Z"
                  fill="#F03C24"
                />
              </svg>
            </div>
            <div>
              <p className="text-lg font-medium">{title}</p>
              <p className="text-base text-white/80 mt-2">{description}</p>
            </div>
            <Link
              to={ctaHref}
              className="w-full text-center px-5 py-2 bg-[#F03C24] text-white font-medium rounded-lg hover:bg-[#d33520] transition-colors"
              aria-label="Apply for Legion token sale"
            >
              {ctaText}
            </Link>
          </div>
        </div>
      </PopoverContent>
    </Popover>
  )
}
